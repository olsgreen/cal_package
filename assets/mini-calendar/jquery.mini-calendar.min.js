/*
	Compressed from: jquery.mini-calendar.js
	On: 01/09/2014 13:53
	For licences see original source files.
*/

$(function(){$.fn.miniCalendar=function(f){var c={},h=$.Deferred(),b={month:new Date().getMonth(),year:new Date().getFullYear()};f=$.extend({url:"",data:{},events:[],dayOnMouseOver:function(j,k){},dayOnMouseOut:function(j,k){},dayOnClick:function(j,k){},error:function(j){}},f);function d(u,o,q){var n=new Array("January","February","March","April","May","June","July","August","September","October","November","December");if(typeof o=="number"){b.month=o}if(typeof q=="number"){b.year=q}var r=new Date(b.year,b.month,1);var s=new Date(b.year,b.month,(r.getDate())-r.getDay());var t=((new Date(b.year,b.month+1,0).getDate())+r.getDay());if(new Date(s.getFullYear(),s.getMonth(),s.getDate()+t).getDay()<=6){t+=(6-new Date(s.getFullYear(),s.getMonth(),s.getDate()+t).getDay())}var l=$("<table></table>"),p;u.append($("<div></div>").html(n[b.month]).addClass("month-name"));var j=$("<tr></tr>").addClass("header").append($("<td></td>").html("Sun")).append($("<td></td>").html("Mon")).append($("<td></td>").html("Tue")).append($("<td></td>").html("Wed")).append($("<td></td>").html("Thu")).append($("<td></td>").html("Fri")).append($("<td></td>").html("Sat"));l.append(j);for(var m=0;m<=t;m++){if(m/7==parseInt(m/7)){l.append(p);p=$("<tr></tr>")}var k=$("<td></td>").html(s.getDate()).attr("data-date",s.getFullYear()+"-"+s.getMonth()+"-"+s.getDate());if(s.getMonth()!=b.month){k.addClass("filler-day")}p.append(k);s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)}l.append(p);u.append(l).addClass("mini-calendar")}function a(m){var j=m.split(" "),k=j[0].split("-"),l=j[1].split(":");k[1]--;return k.concat(l)}function g(n){for(var l=0;l<f.events.length;l++){var o=new Date(f.events[l].start),k=new Date(f.events[l].end),m=true;while(o<=k){var j=o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate();n.find("td[data-date="+j+"]").addClass("selected");if(typeof c[j]!="object"){c[j]=[]}c[j].push($.extend({startDay:m},f.events[l]));o=new Date(o.getFullYear(),o.getMonth(),o.getDate()+1);m=false}}h.resolve()}function i(j){j.find("td").bind("click mouseover mouseout",function(k){if(c[$(this).attr("data-date")]){switch(k.type){case"click":f.dayOnClick(k,c[$(this).attr("data-date")]);break;case"mouseover":f.dayOnMouseOver(k,c[$(this).attr("data-date")]);break;case"mouseout":f.dayOnMouseOut(k,c[$(this).attr("data-date")]);break}}})}function e(){$.ajax({dataType:"json",url:f.url,data:$.extend({start:(new Date(b.year,b.month,1).getTime()/1000),end:(new Date(b.year,b.month+1,0).getTime()/1000),_:new Date(b.year,b.month+1,0).getTime()},f.data),success:function(j){f.events=j;h.notify()},error:function(j){h.reject(j)}})}return this.each(function(){var j=$(this);h.promise().progress(function(){g(j)}).done(function(){i(j)}).fail(function(k){f.error(k)});d(j);if(f.url.length>0){e()}else{h.notify()}})}});
